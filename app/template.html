<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nueva P√°gina - Mi Aplicaci√≥n</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/layout.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/auth.css">
</head>
<body>
    <!-- Auth Overlay -->
    <div id="authOverlay" class="auth-overlay" style="display: none;">
        <div class="auth-modal">
            <h2>üîí Acceso Requerido</h2>
            <p>Para acceder a esta aplicaci√≥n, necesitas iniciar sesi√≥n con tu cuenta.</p>
            <button id="loginButton" class="auth-button">üîë Iniciar Sesi√≥n</button>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Mi App</h2>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="/app/" class="nav-link">üè† Aplicaci√≥n</a></li>
                    <li><a href="/app/dashboard.html" class="nav-link">üìä Dashboard</a></li>
                    <li><a href="/app/articles.html" class="nav-link">üìù Art√≠culos</a></li>
                    <li><a href="/app/users.html" class="nav-link">üë• Usuarios</a></li>
                    <li><a href="/app/settings.html" class="nav-link">‚öôÔ∏è Configuraci√≥n</a></li>
                    <li><a href="/app/reports.html" class="nav-link">üìà Reportes</a></li>
                    <li><a href="/app/messages.html" class="nav-link">üí¨ Mensajes</a></li>
                    <li><a href="/app/notifications.html" class="nav-link">üîî Notificaciones</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Topbar -->
            <header class="topbar">
                <div class="topbar-left">
                    <h1>Nueva P√°gina</h1>
                </div>
                
                <div class="topbar-right">
                    <div id="userButton" class="user-button" style="display: none;">
                        <img id="userPicture" class="user-picture" src="" alt="Foto de perfil" style="display: none;">
                        <div id="userInitial" class="user-initial" style="display: none;">U</div>
                        
                        <div id="userDropdown" class="user-dropdown">
                            <div class="user-info">
                                <p><strong id="userName">Usuario</strong></p>
                                <p id="userEmail">usuario@email.com</p>
                                <p><small>ID: <span id="userId">user_id</span></small></p>
                                <p><small>Verificado: <span id="userVerified">No</span></small></p>
                            </div>
                            <button id="logoutButton" class="logout-button">üö™ Cerrar Sesi√≥n</button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="content">
                <div class="article">
                    <h2>Contenido de la Nueva P√°gina</h2>
                    <p>Este es el contenido de tu nueva p√°gina protegida.</p>
                    
                    <div class="content-section">
                        <h3>Caracter√≠sticas de Seguridad</h3>
                        <ul>
                            <li>‚úÖ Validaci√≥n inmediata de autenticaci√≥n</li>
                            <li>‚úÖ Redirecci√≥n autom√°tica al login si no est√° autenticado</li>
                            <li>‚úÖ Protecci√≥n de todas las p√°ginas en `/app/`</li>
                            <li>‚úÖ No se muestra contenido sin autenticaci√≥n</li>
                        </ul>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.auth0.com/js/auth0-spa-js/1.13/auth0-spa-js.production.js"></script>
    <script src="/assets/js/env-config.js"></script>
    <script src="/assets/js/app-protection.js"></script>
    <script src="/assets/js/utils.js"></script>
    <script src="/assets/js/auth.js"></script>
    
    <script>
        // ===== INICIALIZACI√ìN DESPU√âS DE PROTECCI√ìN =====
        document.addEventListener('DOMContentLoaded', function() {
            // Solo inicializar si la protecci√≥n pas√≥
            if (window.APP_PROTECTION_PASSED) {
                // Obtener referencias a elementos del DOM
                authOverlay = document.getElementById('authOverlay');
                loginButton = document.getElementById('loginButton');
                userButton = document.getElementById('userButton');
                userDropdown = document.getElementById('userDropdown');
                logoutButton = document.getElementById('logoutButton');
                userName = document.getElementById('userName');
                userEmail = document.getElementById('userEmail');
                userId = document.getElementById('userId');
                userVerified = document.getElementById('userVerified');
                
                // Inicializar Auth0
                AuthManager.initAuth0();
            }
        });
    </script>
</body>
</html>
